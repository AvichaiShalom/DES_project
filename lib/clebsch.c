#include <stdlib.h>
#include <stdint.h>

/*
int clebsch_adj_mat[16][16] = {
    {0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0},
    {1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0},
    {0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0},
    {0, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0},
    {1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0},
    {0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1},
    {0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1},
    {1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1},
    {0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1},
    {1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1},
    {0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0},
    {1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0},
    {0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0},
    {0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1},
    {0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0},
    {0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0}
};
*/

int clebsch_adj_lst[16][5] = {
    {1, 4, 7, 9, 11},
    {0, 2, 5, 8, 12},
    {1, 3, 6, 9, 13},
    {2, 4, 5, 7, 14},
    {0, 3, 6, 8, 10},
    {1, 3, 10, 11, 15},
    {2, 4, 11, 12, 15},
    {0, 3, 12, 13, 15},
    {1, 4, 13, 14, 15},
    {0, 2, 10, 14, 15},
    {4, 5, 9, 12, 13},
    {0, 5, 6, 13, 14},
    {1, 6, 7, 10, 14},
    {2, 7, 8, 10, 11},
    {3, 8, 9, 11, 12},
    {5, 6, 7, 8, 9}
};

void clebsch_subkeys(uint64_t subkeys[16], uint64_t key) {
    uint64_t new_subkeys[16];
    int next[5];
    int node, t, i;

    srand((unsigned int)(key ^ (key >> 32)));
    for (i = 0; i < 5; i++) {
        next[i] = rand() % 5;
    }
    for (node = 0; node < 16; node++) {
        new_subkeys[node] = subkeys[node];

        t = node;
        for (i = 0; i < 5; i++) {
            new_subkeys[t] ^= subkeys[clebsch_adj_lst[t][next[i]]];
            t = clebsch_adj_lst[t][next[i]];
        }
    }

    for (i = 0; i < 16; i++) {
        subkeys[i] = new_subkeys[i];
    }
}